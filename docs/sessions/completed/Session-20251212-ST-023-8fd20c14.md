# Session: ST-023 - Stabilize Deploy-Time Data Operations (Seeding + Post-Deploy Job)

**Task ID:** ST-023  
**Status:** Complete  
**Started:** 2025-12-12  
**Completed:** 2025-12-12  
**Platform:** Cursor  
**Module:** `scripts/`, `package.json`, DigitalOcean App Platform

---

## Summary

Production deployments were failing/rolling back due to **non-deterministic data mutation scripts** running at the wrong time (during web startup and/or via a post-deploy job). The fix was to make these flows **explicit entrypoints** and remove shell/operator pitfalls from DigitalOcean job commands.

## What Changed

- Ensured realistic seeding does **not** execute as a side-effect of import/bundling on web startup.
- Added a single-purpose entrypoint script for the DigitalOcean post-deploy augmentation pipeline to avoid `pnpm` mis-parsing chained commands.

## Key Commits

- `e6348ea2` - Fix: prevent realistic seed from running on web startup
- `8fd20c14` - Fix: add augment-data job runner for DO (no shell operators)

## Verification

- Web service starts without running realistic seeding on startup.
- Post-deploy augmentation can be invoked via a single script entrypoint (no `&&` chains in `run_command`).

---

## Notes / Follow-ups

- The bypass / feature-flag strategy for seeding still needs full hardening (see ST-020 "Harden SKIP_SEEDING Bypass").
