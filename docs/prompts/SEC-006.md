# SEC-006: Protect Warehouse Transfer Mutations

## Implementation Guide

### Problem
The `warehouseTransfers.ts` router uses `publicProcedure` for the transfer mutation, allowing anyone to move inventory between locations without authentication.

### Affected Endpoints
- `warehouseTransfers.transfer` (line ~15)
- `warehouseTransfers.getStats` (line ~165)

### Solution
1. Import `protectedProcedure` from `server/_core/trpc`
2. Replace `publicProcedure` with `protectedProcedure.use(requirePermission('inventory:transfer'))` for transfer mutation
3. Protect stats query with read permission

### Files to Modify
- `server/routers/warehouseTransfers.ts`

### Verification
```bash
grep "publicProcedure" server/routers/warehouseTransfers.ts
# Should return no results after fix
```

### Acceptance Criteria
- Transfer mutation requires authentication and permission
- Non-authenticated users receive 401 Unauthorized
- Inventory integrity protected
