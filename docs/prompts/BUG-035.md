# BUG-035: Admin Security Test Failures - publicProcedure in Admin Endpoints

## Problem Statement

5 admin endpoints in `server/routers/admin.ts` are using `publicProcedure` instead of `adminProcedure`, causing security test failures in `server/routers/admin-security.test.ts`.

## Affected Endpoints

| Line | Endpoint | Current Comment |
|------|----------|-----------------|
| 330 | `fixUserPermissions` | "intentionally PUBLIC for emergency fixes" |
| 438 | `listUsers` | "intentionally PUBLIC for emergency debugging" |
| 468 | `grantPermission` | "intentionally PUBLIC for emergency fixes" |
| 583 | `clearPermissionCache` | "intentionally PUBLIC for emergency fixes" |
| 616 | `assignSuperAdminRole` | "intentionally PUBLIC for emergency fixes" |

## Root Cause

These endpoints were marked as public "for emergency debugging/fixes" but this violates security best practices. Admin endpoints should use `adminProcedure` to require authentication and admin role.

## Test Failures

```
FAIL  server/routers/admin-security.test.ts > Admin Endpoints Security (CL-003) > should not use publicProcedure in any admin router
Error: Found 5 admin endpoints using publicProcedure. All admin endpoints MUST use adminProcedure.

FAIL  server/routers/admin-security.test.ts > Admin Endpoints Security (CL-003) > should use adminProcedure for all procedures in admin routers
Error: Found 1 admin routers with incorrect procedure types.
```

## Solution

1. Change all 5 `publicProcedure` usages to `adminProcedure`
2. Remove the "intentionally PUBLIC" comments
3. Verify the security tests pass

## Files to Modify

- `server/routers/admin.ts`

## Verification

```bash
pnpm test server/routers/admin-security.test.ts
```

All 3 tests should pass:
- ✅ should not use publicProcedure in any admin router
- ✅ should import adminProcedure or protectedProcedure in all admin routers
- ✅ should use adminProcedure for all procedures in admin routers

## Acceptance Criteria

- [ ] All 5 endpoints changed from `publicProcedure` to `adminProcedure`
- [ ] "intentionally PUBLIC" comments removed
- [ ] `admin-security.test.ts` passes (3/3 tests)
- [ ] No regression in admin functionality
- [ ] Zero TypeScript errors
