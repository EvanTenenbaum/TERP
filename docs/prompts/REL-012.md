# REL-012: Ledger Reconciliation Pack (Balance, Duplicates, Orphans, Locked Period Violations)

<!-- METADATA (for validation) -->
<!-- TASK_ID: REL-012 -->
<!-- TASK_TITLE: Ledger Reconciliation Pack -->
<!-- PROMPT_VERSION: 1.0 -->
<!-- LAST_VALIDATED: 2026-01-08 -->

**Repository:** https://github.com/EvanTenenbaum/TERP  
**Task ID:** REL-012  
**Estimated Time:** 16h  
**Module:** `server/_core/reconciliationService.ts`, `server/accountingDb.ts`

## Implementation Guide

### Problem
A single unbalanced/duplicate/orphaned ledger posting can corrupt reporting.

### Solution
- Detect:
  - unbalanced journals
  - duplicate postings per referenceId/type
  - orphan references
  - postings into locked periods
- Fix mode limited to safe reversals with strict guardrails.

### Deliverables
- Ledger reconciliation module added
- Unbalanced/double-post/orphan checks implemented
- Report includes remediation steps (reversal vs re-post)
- Fix mode: limited to safe reversals with strict guardrails
- Tests covering each violation class

### Acceptance Criteria
- All violation classes detected with actionable remediation guidance.
- Tests exist for each violation class.
