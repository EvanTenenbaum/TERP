# SEC-010: Protect Returns and Refunds Query Endpoints

## Implementation Guide

### Problem
The `returns.ts` and `refunds.ts` routers expose financial data through public queries:
- `returns.getAll` (line ~118)
- `returns.getById` (line ~150)
- `refunds.getAll` (line ~15)
- `refunds.getById` (line ~58)
- `refunds.getByReturn` (line ~159)
- `refunds.getByOriginalTransaction` (line ~188)

### Solution
1. Change all `publicProcedure` to `protectedProcedure`
2. Add permission middleware: `requirePermission('orders:read')` or `requirePermission('orders:returns:read')`

### Files to Modify
- `server/routers/returns.ts`
- `server/routers/refunds.ts`

### Verification
```bash
grep "publicProcedure" server/routers/returns.ts server/routers/refunds.ts
# Should return no results after fix
```

### Acceptance Criteria
- All financial data queries require authentication
- Non-authenticated users receive 401 Unauthorized
- Privacy of financial records protected
