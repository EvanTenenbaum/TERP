# UX-021: Customizable Quick Actions Dropdown

## Overview

Add a customizable quick actions dropdown menu in the application header that allows users to quickly access frequently used actions without navigating through menus.

## Problem Statement

Users frequently need to perform common actions like creating orders, adding clients, or generating invoices. Currently, they must navigate through the sidebar or multiple pages to access these functions. A quick actions dropdown in the header would significantly improve workflow efficiency.

## Objectives

1. Add a quick actions dropdown menu in the header
2. Allow users to customize which actions appear in the dropdown
3. Persist user preferences across sessions
4. Provide sensible defaults for new users
5. Support keyboard shortcuts for power users

## Technical Approach

### Component Structure

```
AppHeader
└── QuickActionsDropdown
    ├── DropdownTrigger (icon button)
    ├── DropdownContent
    │   ├── QuickActionItem (repeated)
    │   └── CustomizeButton
    └── CustomizeDialog (modal for configuration)
```

### Default Quick Actions

1. **New Order** - Navigate to order creator
2. **New Client** - Open client creation form
3. **New Invoice** - Navigate to invoice creation
4. **New Calendar Event** - Open event creation modal
5. **Quick Search** - Focus global search (Cmd/Ctrl + K)

### Available Actions Pool

Users can choose from these actions to customize their dropdown:

- New Order
- New Client
- New Invoice
- New Bill
- New Calendar Event
- New Todo Task
- View Dashboard
- View Inventory
- View Orders
- View Clients
- Quick Search
- Settings

### Database Schema

```sql
-- Add to user_preferences or create new table
CREATE TABLE user_quick_actions (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT NOT NULL REFERENCES users(id),
  action_key VARCHAR(50) NOT NULL,
  position INT NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY unique_user_action (user_id, action_key),
  INDEX idx_user_id (user_id)
);
```

### API Endpoints (tRPC)

```typescript
// server/routers/userPreferences.ts
export const userPreferencesRouter = router({
  // Get user's quick actions
  getQuickActions: protectedProcedure
    .query(async ({ ctx }) => { ... }),

  // Update user's quick actions
  updateQuickActions: protectedProcedure
    .input(z.object({
      actions: z.array(z.string()),
    }))
    .mutation(async ({ ctx, input }) => { ... }),

  // Reset to defaults
  resetQuickActions: protectedProcedure
    .mutation(async ({ ctx }) => { ... }),
});
```

### UI Components

#### QuickActionsDropdown

```tsx
// client/src/components/layout/QuickActionsDropdown.tsx
export const QuickActionsDropdown = React.memo(function QuickActionsDropdown() {
  const { data: quickActions } =
    trpc.userPreferences.getQuickActions.useQuery();

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="icon" aria-label="Quick actions">
          <Zap className="h-4 w-4" />
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end" className="w-56">
        <DropdownMenuLabel>Quick Actions</DropdownMenuLabel>
        <DropdownMenuSeparator />
        {quickActions?.map(action => (
          <QuickActionItem key={action.key} action={action} />
        ))}
        <DropdownMenuSeparator />
        <DropdownMenuItem onClick={openCustomizeDialog}>
          <Settings className="mr-2 h-4 w-4" />
          Customize...
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
});
```

#### Customize Dialog

- Drag-and-drop reordering of actions
- Checkbox to enable/disable actions
- Maximum of 8 quick actions
- Reset to defaults button

### Keyboard Shortcuts

| Shortcut  | Action                                          |
| --------- | ----------------------------------------------- |
| `Alt + Q` | Open quick actions dropdown                     |
| `1-8`     | Execute action by position (when dropdown open) |

## Acceptance Criteria

- [ ] Quick actions dropdown appears in header
- [ ] Dropdown shows user's configured actions
- [ ] Users can customize actions via dialog
- [ ] Preferences persist across sessions
- [ ] Default actions provided for new users
- [ ] Keyboard shortcuts work
- [ ] Mobile-friendly (touch targets, responsive)
- [ ] Accessible (ARIA labels, keyboard navigation)
- [ ] Unit tests for components
- [ ] Integration tests for preferences API

## Estimate

- **Phase 1**: Core dropdown component + defaults (4h)
- **Phase 2**: Customization UI + persistence (4h)
- **Total**: 8 hours

## Notes

- Use shadcn/ui DropdownMenu component
- Consider using react-beautiful-dnd for drag-and-drop in customize dialog
- Cache preferences in React Query for instant loading
- Consider adding recently used actions section in future
