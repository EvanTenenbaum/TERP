# SEC-005: Protect Location Router Mutations

## Implementation Guide

### Problem
The `locations.ts` router uses `publicProcedure` for all CRUD mutations, allowing anyone to create, update, or delete warehouse locations without authentication.

### Affected Endpoints
- `settings.locations.create` (line ~71)
- `settings.locations.update` (line ~100)
- `settings.locations.delete` (line ~133)

### Solution
1. Import `protectedProcedure` from `server/_core/trpc`
2. Replace `publicProcedure` with `protectedProcedure.use(requirePermission('inventory:locations:manage'))` for all mutations
3. Keep queries as protected but with read permissions

### Files to Modify
- `server/routers/locations.ts`

### Verification
```bash
grep "publicProcedure" server/routers/locations.ts
# Should return no results after fix
```

### Acceptance Criteria
- All location mutations require authentication
- Non-authenticated users receive 401 Unauthorized
- Existing functionality preserved for authenticated users
