# BUG-025: Analytics Data Not Populated

<!-- METADATA (for validation) -->
<!-- TASK_ID: BUG-025 -->
<!-- TASK_TITLE: Analytics Data Not Populated -->
<!-- PROMPT_VERSION: 1.0 -->
<!-- LAST_VALIDATED: 2025-12-17 -->

## Context

**Problem:**
The Analytics page shows placeholder values (e.g., $0.00 / 0) even when real business data exists. This prevents users from using analytics for decision-making.

**Goal:**
Connect the Analytics frontend to real backend aggregates so `/analytics` displays correct metrics with safe loading/empty/error states.

## Implementation Guide

### What “done” means

- Analytics UI loads real values from the backend (no hardcoded 0s)
- Empty database returns zeros without crashing
- Permission checks remain enforced (`analytics:read`)
- Basic tests/smoke checks exist so we don’t regress

### Suggested approach

1. **Audit the current Analytics UI**
   - Review `client/src/pages/AnalyticsPage.tsx`
   - Identify which values are placeholders vs coming from real queries

2. **Add/extend backend analytics endpoints**
   - Inspect `server/routers/analytics.ts`
   - If “business metrics” endpoints don’t exist yet, add procedures that compute:
     - Total orders
     - Total clients
     - Total inventory items / batches
     - Revenue totals (if applicable / if schema supports)
   - Ensure every procedure is guarded with `requirePermission("analytics:read")`

3. **Wire frontend to backend**
   - Use tRPC queries from the Analytics page to fetch metrics
   - Add loading and error states (don’t just render zeros)
   - Ensure the UI still renders quickly (avoid multiple redundant queries if one aggregate endpoint can return a single object)

4. **Validation**
   - Spot-check against DB: confirm numbers are plausible (counts align with list pages)
   - Add at least one basic test (router unit test or a minimal smoke script) verifying non-negative numeric outputs and stable response shape
