# SEC-007: Protect Order Enhancement Mutations (11 Endpoints)

## Implementation Guide

### Problem
The `orderEnhancements.ts` router uses `publicProcedure` for 11 business-critical mutations, exposing recurring orders, payment terms, and alert configurations to unauthenticated access.

### Affected Endpoints
1. `createRecurringOrder` (line ~12)
2. `updateRecurringOrder` (line ~39)
3. `pauseRecurringOrder` (line ~58)
4. `resumeRecurringOrder` (line ~64)
5. `cancelRecurringOrder` (line ~70)
6. `reorderFromPrevious` (line ~100)
7. `updateClientPaymentTerms` (line ~137)
8. `createAlertConfiguration` (line ~205)
9. `updateAlertConfiguration` (line ~229)
10. `deleteAlertConfiguration` (line ~245)
11. `toggleAlertConfiguration` (line ~261)

### Solution
1. Import `protectedProcedure` from `server/_core/trpc`
2. Replace all `publicProcedure` with appropriate protected procedures:
   - Recurring order mutations: `requirePermission('orders:create')`
   - Payment terms: `requirePermission('orders:update_payment_terms')`
   - Alert configurations: `requirePermission('orders:manage_alerts')`

### Files to Modify
- `server/routers/orderEnhancements.ts`

### Verification
```bash
grep "publicProcedure" server/routers/orderEnhancements.ts
# Should return no results after fix
```

### Acceptance Criteria
- All 11 endpoints require authentication
- Appropriate permission checks per operation type
- No regression in authenticated user functionality
