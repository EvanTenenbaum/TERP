# REL-007: Inventory Movements Immutability + Reversal-Only Corrections

<!-- METADATA (for validation) -->
<!-- TASK_ID: REL-007 -->
<!-- TASK_TITLE: Inventory Movements Immutability -->
<!-- PROMPT_VERSION: 1.0 -->
<!-- LAST_VALIDATED: 2026-01-08 -->

**Repository:** https://github.com/EvanTenenbaum/TERP  
**Task ID:** REL-007  
**Estimated Time:** 16h  
**Module:** `server/inventoryMovementsDb.ts`, `drizzle/`

## Implementation Guide

### Problem
Editing/deleting posted movements breaks auditability and prevents reconstruction.

### Solution
- Enforce append-only movements.
- Introduce reversal records:
  - reversal movement references original movement id
  - reversal delta negates original delta
- Guard update/delete paths for posted movements (allow only strict audited soft delete if absolutely required).

### Files
- `server/inventoryMovementsDb.ts`
- `drizzle/` schema and migrations

### Tests
- Create movement, reverse it, verify projection and reconstruction both return original state.

### Acceptance Criteria
- Posted movements cannot be mutated in place.
- Reversals are first-class and audited.
