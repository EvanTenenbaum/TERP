# BUG-023: Inconsistent Layout Between Dashboard and Module Pages

**Repository:** https://github.com/EvanTenenbaum/TERP
**Task ID:** BUG-023
**Priority:** HIGH
**Estimated Time:** 8-16 hours
**Module:** `client/src/components/layout/`

---

## Context

Dashboard and module pages use different layout configurations causing an inconsistent navigation experience:

- **Dashboard**: Uses DashboardLayout with updated sidebar but NO header
- **Module pages** (Orders, Inventory, etc.): Have header but use older/incomplete sidebar via AppShell

This creates a jarring UX where the sidebar menu items change as users navigate between sections.

## Implementation Guide

### Step 1: Audit Current Layout Architecture

Identify all layout components:

```bash
ls -la client/src/components/layout/
grep -r "AppShell\|DashboardLayout\|Layout" client/src --include="*.tsx"
```

Key files to analyze:

- `client/src/components/layout/AppShell.tsx`
- `client/src/components/DashboardLayout.tsx`
- `client/src/App.tsx` (route configuration)

### Step 2: Document Current Behavior

Create a matrix of:

- Which routes use which layout
- Header presence per route
- Sidebar navigation items per route

### Step 3: Choose Unification Strategy

**Option A: Extend DashboardLayout to all pages**

- Add header to DashboardLayout
- Use DashboardLayout for all authenticated routes
- Remove AppShell or make it a wrapper only

**Option B: Extend AppShell with consistent sidebar**

- Update AppShell sidebar to match DashboardLayout
- Ensure header present on all pages including dashboard

### Step 4: Implement Unified Layout

Example approach (Option A):

```tsx
// In DashboardLayout.tsx, ensure header is included
export function DashboardLayout({ children }: Props) {
  return (
    <SidebarProvider>
      <div className="flex min-h-screen">
        <Sidebar />
        <div className="flex-1 flex flex-col">
          <Header /> {/* Add this */}
          <main className="flex-1">{children}</main>
        </div>
      </div>
    </SidebarProvider>
  );
}
```

### Step 5: Update Route Configuration

Ensure all authenticated routes use the unified layout:

```tsx
// In App.tsx
<DashboardLayout>
  <Route path="/dashboard" component={Dashboard} />
  <Route path="/orders" component={Orders} />
  <Route path="/inventory" component={Inventory} />
  {/* ... all other routes */}
</DashboardLayout>
```

### Step 6: Verify Navigation Consistency

- All pages have header
- All pages have same sidebar with same navigation items
- No duplicate navigation elements
- Sidebar state (expanded/collapsed) persists across navigation

### Step 7: Test Navigation Flow

- Navigate from Dashboard to Orders
- Navigate from Orders to Inventory
- Navigate from Inventory back to Dashboard
- Use sidebar links
- Use header navigation
- Verify no layout shift or flicker

## Success Criteria

- [ ] Header appears on ALL pages (including Dashboard)
- [ ] Sidebar navigation is identical on ALL pages
- [ ] No duplicate navigation elements appear
- [ ] Smooth navigation without layout shifts
- [ ] Sidebar state persists across navigation
- [ ] All tests passing
- [ ] Zero TypeScript errors

---

**Last Updated:** November 30, 2025
