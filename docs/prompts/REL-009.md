# REL-009: Reconciliation Framework (Report Mode + Controlled Fix Hooks)

<!-- METADATA (for validation) -->
<!-- TASK_ID: REL-009 -->
<!-- TASK_TITLE: Reconciliation Framework -->
<!-- PROMPT_VERSION: 1.0 -->
<!-- LAST_VALIDATED: 2026-01-08 -->

**Repository:** https://github.com/EvanTenenbaum/TERP  
**Task ID:** REL-009  
**Estimated Time:** 2d  
**Module:** `server/_core/`, `scripts/`, `docs/reliability/`

## Implementation Guide

### Problem
No unified reconciliation runner to detect drift across inventory/money/ledger/RBAC.

### Solution
- Add `server/_core/reconciliationService.ts` with pluggable scopes:
  - inventory, ar, ap, ledger, rbac
- Add CLI runner:
  - `scripts/reconcile.ts --mode=report|fix --scope=...`
- Report must be JSON and stable (schema committed).

### Deliverables
- Add `server/_core/reconciliationService.ts`
- Add `scripts/reconcile.ts --mode=report|fix --scope=inventory|ar|ap|ledger|rbac`
- Integrate with logging + Sentry breadcrumbs
- Add docs + runbook for interpreting reports

### Acceptance Criteria
- Report mode produces deterministic JSON for each scope.
- Fix mode exists but is guarded and auditable.
