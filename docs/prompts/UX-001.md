# UX-001: Implement Form Dirty State Protection

## Implementation Guide

### Problem
Users can navigate away from forms with unsaved changes without any warning. All form data is lost.

### Affected Components
- All modal forms (PurchaseModal, EditBatchModal, TaskForm, etc.)
- Page forms (OrderCreatorPage, ClientProfilePage)

### Solution
1. Create `useFormDirtyState` hook
2. Add `beforeunload` event listener
3. Show confirmation dialog on navigation with unsaved changes

### Files to Create/Modify
- Create `client/src/hooks/useFormDirtyState.ts`
- Apply to all form components

### Implementation
```typescript
// useFormDirtyState.ts
export function useFormDirtyState(isDirty: boolean) {
  useEffect(() => {
    const handler = (e: BeforeUnloadEvent) => {
      if (isDirty) {
        e.preventDefault();
        e.returnValue = '';
      }
    };

    window.addEventListener('beforeunload', handler);
    return () => window.removeEventListener('beforeunload', handler);
  }, [isDirty]);
}

// Usage with react-hook-form
const { formState: { isDirty } } = useForm();
useFormDirtyState(isDirty);
```

### Acceptance Criteria
- Browser prompts before navigation with unsaved changes
- In-app navigation shows confirmation dialog
- Form data preserved until explicitly discarded
