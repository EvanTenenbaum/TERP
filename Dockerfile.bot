FROM node:20-slim

# Install git (required for bot operations)
RUN apt-get update && apt-get install -y --no-install-recommends git curl && \
    rm -rf /var/lib/apt/lists/*

# Enable pnpm via corepack
RUN corepack enable && corepack prepare pnpm@latest --activate

WORKDIR /app

# Copy only the startup script (minimal, no code)
COPY scripts/bot-start.sh /app/bot-start.sh
RUN chmod +x /app/bot-start.sh

# Start the bot (script handles cloning, install, run)
CMD ["/app/bot-start.sh"]
